@startuml
skinparam classFontStyle Bold
hide empty members

' =======================
'      Package races
' =======================
package races {
    abstract class Race {
        - nom: String
        - dexterite: int
        - force: int
        - vitesse: int
        - pointsDeVie: int
        - initiative: int

        + Race(nom: String)
        + appliquerRace(personnage: Personnage): void ' applique les bonus/malus de race
        + setDexterite(dexterite: int): void
        + setForce(force: int): void
        + setVitesse(vitesse: int): void
        + setPointsDeVie(pointsDeVie: int): void
        + setInitiative(initiative: int): void
        + getDexterite(): int
        + getForce(): int
        + getVitesse(): int
        + getPointsDeVie(): int
        + getInitiative(): int
        + getNom(): String
    }

    class Humain extends Race
    class Elfe extends Race
    class Nain extends Race
    class Halfelin extends Race
}

' =======================
'      Package classes
' =======================
package classes {
    abstract class Classe {
        - nom: String
        - pointsDeVie: int
        - equipementDeBase: List<Equipement>
        - sortsDisponibles: List<Sort>

        + Classe(nom: String, pointsDeVie: int)
        + getNomClasse(): String
        + getPointsDeVie(): int
        + getEquipementDeBase(): List<Equipement>
        + getSortsDisponibles(): List<Sort>
        + ajouterSort(classe: Classe, sort: Sort): void ' ajoute un sort à la classe
        + ajouterEquipement(equipement: Equipement): void ' ajoute un équipement de base
    }

    class Guerrier extends Classe
    class Magicien extends Classe
    class Clerc extends Classe
    class Roublard extends Classe
}

' =======================
'      Package equipements
' =======================
package equipements {
    interface Equipement {
        + getNom(): String
        + appliquerEffets(p: Joueur): void ' applique les effets de l'équipement
        + getType(): TypeEquipement
        + toString(): String
    }

    enum TypeEquipement {
        ARME
        ARMURE
    }

    enum Arme implements Equipement {
        BATON
        MASSE_D_ARMES
        EPEE_LONGUE
        RAPIERE
        ARBALETE_LEGERE
        FRONDE
        ARC_COURT
        --
        - nom: String
        - degats: String
        - portee: int
        - estArmeDeGuerre: Boolean
        --
        + getNom(): String
        + getDegats(): String
        + getDegatsNumeriques(): int
        + getPortee(): int
        + estArmeDeGuerre(): boolean
        + appliquerEffets(p: Joueur): void ' applique bonus/malus arme
        + toString(): String
    }

    enum Armure implements Equipement {
        ARMURE_ECAILLES
        DEMI_PLATE
        COTTE_DE_MAILLES
        HARNOIS
        --
        - nom: String
        - classeArmure: int
        - estArmureLourde: Boolean
        --
        + getNom(): String
        + getClasseArmure(): int
        + estArmureLourde(): boolean
        + appliquerEffets(p: Joueur): void ' applique malus armure lourde
        + getType(): TypeEquipement
        + toString(): String
    }
}

' =======================
'      Package sorts
' =======================
package sorts {
    abstract class Sort {
        - nom: String
        + getNom(): String
        + utiliserSort(lanceur: Joueur, joueurs: List<Joueur>, monstres: List<Monstre>): void ' effet du sort sur cibles
    }

    class ArmeMagique extends Sort
    class Guerison extends Sort
    class BoogieWoogie extends Sort
}

' =======================
'      Package personnage
' =======================
package personnage {
    abstract class Personnage {
        - nom: String
        - race: Race
        - classe: Classe
        - pointsDeVie: int
        - force: int
        - dexterite: int
        - vitesse: int
        - initiative: int
        - inventaire: List<Equipement>
        - armeEquipe: Arme
        - armurEquipe: Armure
        - x: int
        - y: int

        + Personnage(nom: String, pv: int, force: int, dex: int, vit: int)
        + getNom(): String
        + getPointsDeVie(): int
        + setPointsDeVie(pv: int): void
        + getForce(): int
        + getDexterite(): int
        + getVitesse(): int
        + getInitiative(): int
        + setInitiative(i: int): void
        + getX(): int
        + getY(): int
        + setX(x: int): void
        + setY(y: int): void
        + seDeplacer(x: int, y: int): void ' déplace le personnage
        + estMort(): boolean
        + attaquer(cible: Personnage): void ' attaque une cible
        + jouerTour(donjon: Donjon): void ' actions du tour
        + mourir(donjon: Donjon): void ' gère la mort du personnage
    }

    class Joueur extends Personnage {
        - sorts: List<Sort>
        + Joueur(nom: String)
        + getRace(): Race
        + getClasse(): Classe
        + afficherJoueur(): String ' affiche fiche détaillée
        + afficherInfos(): String ' affiche résumé joueur
        + ramasser(equipement: Equipement): void ' ajoute équipement à l'inventaire
        + equiperInventaire(): void ' équipe un objet de l'inventaire
        + utiliserSort(donjon: Donjon): void ' lance un sort
        + restaurerVie(): void ' restaure la vie au max
        + getPointsDeVieMax(): int
        + getArmes(): List<Arme>
        + modifierForce(points: int): void
        + modifierVitesse(points: int): void
    }

    class Monstre extends Personnage {
        - numero: int
        - attaque: String
        - portee: int
        - degats: String
        - classeArmure: int
        + Monstre(nom: String, numero: int, attaque: String, portee: int, degats: String, pointsDeVie: int, vitesse: int, force: int, dexterite: int, classeArmure: int, initiative: int)
        + attaquer(cible: Personnage): void ' attaque un personnage
    }

    class MaitreDuJeu {
        - donjon: Donjon
        + MaitreDuJeu()
        + creerDonjon(): Donjon ' création du donjon (console)
        + ajouterMonstre(): void ' ajoute des monstres au donjon
        + ajouterJoueur(): void ' ajoute des joueurs au donjon
        + ajouterEquipement(): void ' ajoute des équipements au donjon
        + miseEnPlace(): void ' prépare la partie
        + passerAuDonjon(): void ' lance la phase donjon
        + getDonjon(): Donjon
    }
}

' =======================
'      Package jeu
' =======================
package jeu {
    class Donjon {
        - hauteur: int
        - largeur: int
        - carte: String[][]
        - monstres: List<Monstre>
        - joueurs: List<Joueur>
        - equipementsListe: List<Equipement>

        + Donjon(hauteur: int, largeur: int)
        + creerCarte(): void ' initialise la carte du donjon
        + positionnerObstacles(nombreObstacles: int): void ' place des obstacles aléatoirement
        + placerEquipement(equipement: Equipement, x: int, y: int): boolean ' place un équipement sur la carte
        + placerMonstreAleatoirement(monstre: Monstre, numero: int): void ' place un monstre aléatoirement
        + placerMonstre(monstre: Monstre, x: int, y: int, numero: int): void ' place un monstre à une position
        + placerJoueur(joueur: Joueur, x: int, y: int, numeroJoueur: int): boolean ' place un joueur à une position
        + afficherCarte(): void ' affiche la carte du donjon
        + ordreJeuJoueur(): List<Joueur> ' ordre d'initiative des joueurs
        + ordreJeuMonstre(): List<Monstre> ' ordre d'initiative des monstres
        + lancerDes(): int ' lance un dé 20
        + getHauteur(): int
        + getLargeur(): int
        + getMonstres(): List<Monstre>
        + getJoueurs(): List<Joueur>
        + getEquipementAtPosition(x: int, y: int): Equipement
    }

    class Jeu {
        - tour: int
        - maitreDuJeu: MaitreDuJeu
        - listeMonstres: List<Monstre>
        - listeJoueurs: List<Joueur>
        - listeEntite: List<Personnage>

        + Jeu()
        + lancerJeu(): void ' démarre la partie
        + jouerTour(): void ' joue un tour complet
        + afficherOrdreDeJeu(): void ' affiche l'ordre d'initiative
        + boucleJeu(): void ' boucle principale du jeu
        + getMaitreDuJeu(): MaitreDuJeu
    }
}

' =======================
'      Relations
' =======================
personnage.Joueur o-- races.Race
personnage.Joueur o-- classes.Classe
personnage.Joueur o-- equipements.Arme
personnage.Joueur o-- equipements.Armure
personnage.Joueur o-- equipements.Equipement
personnage.Joueur o-- sorts.Sort

personnage.Monstre --|> personnage.Personnage
personnage.Joueur --|> personnage.Personnage

jeu.Donjon o-- personnage.Joueur
jeu.Donjon o-- personnage.Monstre
jeu.Donjon o-- equipements.Equipement

jeu.Jeu o-- personnage.Joueur
jeu.Jeu o-- personnage.Monstre
jeu.Jeu o-- personnage.MaitreDuJeu

personnage.MaitreDuJeu o-- jeu.Donjon

classes.Classe o-- equipements.Equipement
classes.Classe o-- sorts.Sort

equipements.Arme ..|> equipements.Equipement
equipements.Armure ..|> equipements.Equipement

sorts.ArmeMagique --|> sorts.Sort
sorts.Guerison --|> sorts.Sort
sorts.BoogieWoogie --|> sorts.Sort

@enduml